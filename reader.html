<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>القارئ</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <div class="logo" id="title"></div>
</header>

<div class="content" id="surahs"></div>

<div class="player">
  <button onclick="prev()">⏮</button>
  <button onclick="toggle()">▶️/⏸</button>
  <button onclick="next()">⏭</button>
  <span id="now"></span>
</div>

<audio id="audio"></audio>

<script>
let audio=document.getElementById("audio");
let list=[],index=0,server="";

const q=new URLSearchParams(location.search);

fetch("data.json").then(r=>r.json()).then(d=>{
  const reader=d.readers.find(r=>r.id===q.get("id"));
  document.getElementById("title").innerText=reader.name;
  server=reader.server;
  list=d.surahs;

  list.forEach((s,i)=>{
    surahs.innerHTML+=`
      <div class="reader" onclick="play(${i})">
        ${i+1}. ${s}
      </div>`;
  });
});

function play(i){
  index=i;
  audio.src=server+String(i+1).padStart(3,"0")+".mp3";
  audio.play();
  now.innerText=list[i];
}
function toggle(){audio.paused?audio.play():audio.pause();}
function next(){play((index+1)%list.length);}
function prev(){play((index-1+list.length)%list.length);}
audio.onended=next;
</script>

</body>
</html>
