<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>القارئ</title>
<style>
body{font-family:tahoma;margin:0}
header{background:#0e6848;color:#fff;padding:10px;text-align:center}
.surah{padding:10px;border-bottom:1px solid #ddd;cursor:pointer}
.player{position:fixed;bottom:0;width:100%;background:#fff;padding:10px}
</style>
</head>
<body>

<header id="title"></header>
<div id="surahs"></div>

<div class="player">
  <button onclick="prev()">⏮️</button>
  <button onclick="toggle()">▶️/⏸️</button>
  <button onclick="next()">⏭️</button>
  <span id="now"></span>
</div>

<audio id="audio"></audio>

<script>
let audio=document.getElementById("audio");
let list=[],index=0,server="";
const q=new URLSearchParams(location.search);
fetch("data.json").then(r=>r.json()).then(d=>{
  const reader=d.readers.find(r=>r.id===q.get("id"));
  server=reader.server;
  title.innerText=reader.name;
  list=d.surahs;
  list.forEach((s,i)=>{
    surahs.innerHTML+=`
      <div class="surah" onclick="play(${i})">${i+1}. ${s}</div>`;
  });
});
function play(i){
  index=i;
  audio.src=server+String(i+1).padStart(3,"0")+".mp3";
  audio.play();
  now.innerText=list[i];
}
function toggle(){audio.paused?audio.play():audio.pause();}
function next(){play((index+1)%list.length);}
function prev(){play((index-1+list.length)%list.length);}
audio.onended=next;
</script>

</body>
</html>
